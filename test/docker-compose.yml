version: '2'
services:

    mongod1:
        build: ../
        environment:
            rs_name: rs
            storage_engine: rocksdb
        volumes:
             - /srv/mongo/mongod1:/data/db
        ports:
             - "27017:27017"
        networks:
            rs_net:
                ipv4_address: 172.16.238.11
        restart: always

    mongod2:
        build: ../
        environment:
            rs_name: rs
            storage_engine: rocksdb
        volumes:
             - /srv/mongo/mongod2:/data/db
        ports:
             - "27018:27017"
        networks:
            rs_net:
                ipv4_address: 172.16.238.12
        restart: always

    mongod3:
        build: ../
        environment:
            rs_name: rs
            storage_engine: rocksdb
            master: 172.16.238.13
            slaves: 172.16.238.11 172.16.238.12    
        volumes:
             - /srv/mongo/mongod3:/data/db
        ports:
             - "27019:27017"
        networks:
            rs_net:
                ipv4_address: 172.16.238.13
        restart: always

networks:
  rs_net:
    driver: bridge
    ipam:
        driver: default
        config:
        - subnet: 172.16.238.0/24
          gateway: 172.16.238.1